<VirtualHost *:80>
    ServerName jkcorp5005.com
    # 모든 요청을 HTTPS로 리다이렉트
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^/(.*)$ https://jkcorp5005.com/$1 [R=301,L]
    ErrorLog  ${APACHE_LOG_DIR}/bot_http_error.log
    CustomLog ${APACHE_LOG_DIR}/bot_http_access.log combined
</VirtualHost>

<VirtualHost *:443>
    ServerName jkcorp5005.com
    DocumentRoot /var/www/bot/bot

    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/jkcorp5005.com/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/jkcorp5005.com/privkey.pem

    ProxyPreserveHost On
    RequestHeader set X-Forwarded-Proto "https"
    ProxyPass        /api/ http://127.0.0.1:8000/api/
    ProxyPassReverse /api/ http://127.0.0.1:8000/api/

    <Directory /var/www/bot/bot>
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog  ${APACHE_LOG_DIR}/bot_error.log
    CustomLog ${APACHE_LOG_DIR}/bot_access.log combined
</VirtualHost>
